# Workflow 表单数据更新修复测试指南（纯 Blur 策略）

## 测试步骤

### 1. 测试表单字段更新

1. 打开工作流编辑页面
2. 点击任意节点打开 NodeDetail 面板
3. 在 any-of-kind-field 字段中输入值
4. **点击其他字段或按 Tab 键切换焦点**（重要：这是触发保存的时机）
5. 验证输入的值是否在失去焦点时更新（查看控制台日志）

### 2. 测试折叠高级选项

1. 在 NodeDetail 面板中展开"高级选项"
2. 在高级选项中的字段输入一些值
3. **切换焦点确保值被保存**
4. 折叠"高级选项"
5. 再次展开"高级选项"
6. 验证之前输入的值是否仍然存在

### 3. 测试关闭重开 NodeDetail

1. 在 NodeDetail 面板中修改一些字段值
2. **确保修改的字段已失去焦点（或手动点击其他字段）**
3. 关闭 NodeDetail 面板（点击关闭按钮或点击其他区域）
4. 再次点击同一个节点
5. 验证之前修改的值是否仍然保留

### 4. 测试输入流畅性

1. 在任意输入字段中快速连续输入
2. 验证输入过程中没有卡顿或延迟
3. 输入完成后切换焦点，验证数据正确保存

## 预期结果

✅ 输入过程完全流畅，无任何卡顿
✅ 失去焦点时数据立即保存
✅ 折叠/展开高级选项不会导致数据丢失
✅ 关闭并重新打开 NodeDetail 显示最新数据
✅ Select 下拉选择立即生效

## 重要注意事项

⚠️ **数据保存时机**：

- Input 输入框：必须失去焦点才会保存（点击其他地方、按 Tab 键等）
- Select 下拉框：选择后立即保存

⚠️ **测试关键点**：

- 测试时务必在修改输入框后切换焦点
- 如果忘记切换焦点，数据可能不会保存

## 与用户的使用习惯对比

这种策略符合绝大多数 Web 表单的标准行为：

- 用户在输入框中输入内容
- 完成输入后自然地点击下一个字段或按 Tab 键
- 在失去焦点时保存数据

## 调试提示

如果遇到问题，可以查看控制台日志：

- `handleFormChange` - 表单数据更新时的日志（应在失去焦点时出现）
- `anyof-kind-field props` - AnyOfKindField 组件接收的 props

## 性能优势

- ✅ 输入时零延迟，绝对流畅
- ✅ 减少了不必要的表单更新
- ✅ 降低了 CPU 使用率
- ✅ 避免了频繁的重新渲染
